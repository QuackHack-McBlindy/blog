<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ¦†ğŸ§‘â€ğŸ¦¯</title>
    <link rel="stylesheet" href="../css/styles.css">
</head>
<body>

    <div class="navbar">
        <div class="navbar-content">
            <a href="https://github.com/QuackHack-McBlindy" title="GitHub">
                <img src="../img/github_teal.png" alt="GitHub" class="github-icon" style="height: 32px;" onmouseover="this.src='img/github_magenta.png';" onmouseout="this.src='../img/github_teal.png';"> </img>
            </a>
            <img src="../img/logo.png" height="48" width="48" >
            <div class="navbar-title">
                <span>ğŸ¦†</span>ğŸ§‘â€ğŸ¦¯ <a href="https://quackhack-mcblindy.github.io/blog/">ğ‘¸ğ’–ğ’‚ğ’„ğ’Œğ‘¯ğ’‚ğ’„ğ’Œ-ğ‘´ğ’„ğ‘©ğ‘³ğ’Šğ’ğ’…ğ’š blog</a>
            </div>
            <button id="duckToggle" class="toggle-btn">
                <span class="duck-icon">ğŸ¦†</span>
                Hide duck commentary
            </button>
        </div>
    </div>
    

    <div class="toc-container">
        <details class="toc-details">
            <summary class="toc-header">
                <span class="toc-duck">ğŸ¦†</span>
                <h3>Navigation</h3>
                <span class="toc-man">ğŸ§‘â€ğŸ¦¯</span>
                <span class="toc-toggle">â®Ÿ</span>
            </summary>
            <nav class="toc-nav">
                <a href="index.html" class="toc-item current">
                    <span class="toc-icon">ğŸ«€</span>
                    Yo - Define & Unify
                    <span class="current-marker">â®œğŸ¦†</span>                    
                </a>
                <a href="../do/index.html" class="toc-item">
                    <span class="toc-icon">ğŸ§ </span>
                    Do - Listen, Process, Act & Learn
                </a>
                <a href="../house/index.html" class="toc-item">
                    <span class="toc-icon">ğŸ </span>
                    House - Declarative Home Automation
                </a>
                <a href="../docs/index.html" class="toc-item">
                    <span class="toc-icon">ğŸ“š</span>
                    Documentation - Automating the README
                </a>
                <a href="../misc/index.html" class="toc-item">
                    <span class="toc-icon">ğŸ§©</span>
                    Miscellaneous
                </a>
            </nav>
            <div class="toc-footer">
                <span class="toc-quack">ğŸ¦† says â® qwack qwack, plx pick!</span>
            </div>
        </details>
    </div>
    
    
  
    <div class="content">
        <header class="category-title">
            <h1>Yo - Define & Unify</h1>
            <p class="subtitle">This section is about the Heart and Soul of this project.<br></p>
        </header>

        <h2 class="section-title">Why?!</h2>
        

        <p>
            Yo is a Command-Line tool and scripting framework I wrote because of two main reasons:<br><br>
            
            <strong>1. Define</strong><br> I needed somewhere to define my sentences for the voice assistant, and a stable solution for defining the language processor's <i>'tools' (scripts)</i> for execution. <br><br>
            
            <strong>2. Unify</strong><br> Reduced scatter. Ever since I was a kid I have had a golden talent for scattering scripts around me, like a crazy mad man on speed, which sadly in the end of course lead to me loosing a lot of value. <br><br>            
        </p>        

        <h2 class="section-title">Key Features</h2>
          
        <div class="key-features">    
        <div class="feature-card">
            <h3>Centralized Script Management</h3>
            <p>Define all your scripts in one place with consistent structure, eliminating scattered scripts across your system.</p>
            <p>Built entirely in Nix for declarative, reproducible script management across your entire system.</p>
            <p>Unified --help command, Markdown rendered beautifully in the terminal that have extensive parameter documentation.</p>
        </div>
    
        <div class="feature-card">
            <h3>Parameter System</h3>
            <p>Type validation, optional parameters, default values, allowed values, and both positional & named parameter support.</p>
        </div>
 
    
        <div class="feature-card">
            <h3>Automated Execution</h3>
            <p>Schedule scripts to run at boot, periodically, or specific times with systemd integration.</p>
        </div>

        <div class="feature-card">
            <h3>Smart Validation</h3>
            <p>Comprehensive error checking with friendly duck error messages and parameter validation.</p>
        </div>
        
    </div>


        <h2 class="section-title">YO Script Structure<h2>        
        I chose to define my scripts like this:<br>

        <details class="code-block-container" style="margin-bottom: 1em;" open>
          <summary class="code-header">
              <div class="code-lang">â® Hide Scriot Structure</div>
          </summary>
              <div class="code-block">
                <pre><span class="duck-version">
{ # ğŸ¦†saysâ®yo! letz do a script yo!
  config,
  lib,
  pkgs,
  cmdHelpers, # ğŸ¦†saysâ®shared functionz (/bin/helpers.nix)
  ...
} : let
in { # ğŸ¦†saysâ®qwack
  yo = {  
    scripts = {
      bed = { # ğŸ¦†saysâ®plx pick da script name
        description = "Bed controller";
        # ğŸ¦†saysâ®for da --help cmd in da terminal md table & README markdown table
        category = "ğŸ›– Home Automation";
        autoStart = false; # ğŸ¦†saysâ®run bed@boot?
        runEvery = []; # ğŸ¦†saysâ®periodic start (minutes)
        runAt = []; # ğŸ¦†saysâ®scheduled start (list of strings - "HH:MM" 24h format)
        logLevel = "INFO"; # ğŸ¦†saysâ®duckTrace loggin'
        parameters = [    
          { # ğŸ¦†saysâ®paramz haz extensive validation
            name = "part";
            description = "Which part of the bed (head/feet)";
            type = "string";
            values = [ # ğŸ¦†saysâ®doez not run if $part is something else than
              "feet"
              "head"
            ];
            default = "head"; # ğŸ¦†saysâ®if --part iz omitted default value iz uzed for --part
          }
          { 
            name = "state";
            description = "Move up or down";
            type = "string";
            values = [ "down" "up" ];
            default = "up";
          }     
        ];
        helpFooter = ''
          echo "ğŸ¦†saysâ®extra code to be ran and displayed in da scripts --help cmd"     
        '';
        code = ''
          ${cmdHelpers} # ğŸ¦†saysâ®load da shared functionz yo
          dt_debug "Sending bed $part $down" # ğŸ¦†saysâ® duckTrace logging
          # ğŸ¦†saysâ® rezt of da script code
        '';   
        voice = { # ğŸ¦†saysâ®enabled by default if sentences are defined
          priority = 2; # ğŸ¦†saysâ®1-5 (5 lowest)
          fuzzy = {
            enable = true; # ğŸ¦†saysâ® enabled by default if sentences are defined
            threashhold = 15; # ğŸ¦†saysâ®set a script specific fuzzy threashhold
          };  
          sentences = [
# ğŸ¦†saysâ® [these|words] are optiional & can be omitted
# ğŸ¦†saysâ® (these|words) are alternatives - u have to say one of them
# ğŸ¦†saysâ® {this} word is a parameter (must match BOTH scripts parameter AND entity list 
            "[send|control] bed[s] {part} {state}"
            "(take|send|control) {state] [the] bed[s] {part}"
          ];
          lists = { # ğŸ¦†saysâ® entity lists
            part.wildcard = false; # ğŸ¦†saysâ® entities can be wildcards (anything)
            part.values = [
              { # ğŸ¦†saysâ® if u say one of these words
                "in" = "[head|heads|bedhead|top]";
                out = "head"; # ğŸ¦†saysâ® it becomes this word
              }
              { "in" = "[foot|foots|feet|feets]"; out = "feet"; }
            ];
            state.values = [
              { "in" = "[up|upp]"; out = "up"; }             
              { "in" = "[down|downs]"; out = "down"; } 
            ];
          };  
        };
      };
    };  
  
  };}
</span><span class="clean-version hidden">
{
  config,
  lib,
  pkgs,
  cmdHelpers,
  ...
} : let
in {
  yo = {
    scripts = {
      bed = {
        description = "Bed controller";
        category = "ğŸ›– Home Automation";
        autoStart = false;
        runEvery = [];
        runAt = [];
        logLevel = "INFO";
        parameters = [    
          {
            name = "part";
            description = "Which part of the bed (head/feet)";
            type = "string";
            values = [ "feet" "head" ];
            default = "head";
          }
          { 
            name = "state";
            description = "Move up or down";
            type = "string";
            values = [ "down" "up" ];
            default = "up";
          }     
        ];
        helpFooter = ''
          echo "ğŸ¦†saysâ®extra code to be ran and displayed in da scripts --help cmd"   
        '';
        code = ''
          ${cmdHelpers}
          dt_debug "Sending bed $part $down"
          # Rest of the script code
        '';   
        voice = {
          priority = 2;
          fuzzy = {
            enable = true;
            threashhold = 15;
          };  
          sentences = [
            "[send|control] bed[s] {part} {state}"
            "(take|send|control) {state] [the] bed[s] {part}"
          ];
          lists = {
            part.wildcard = false;
            part.values = [
              {
                "in" = "[head|heads|bedhead|top]";
                out = "head";
              }
              { "in" = "[foot|foots|feet|feets]"; out = "feet"; }
            ];
            state.values = [
              { "in" = "[up|upp]"; out = "up"; }             
              { "in" = "[down|downs]"; out = "down"; } 
            ];
          };  
        };
      };
    };  
  
  };}
</span></pre>
            </div>
        </div>
    </details>

    

        <h2 class="section-title">yo --help</h2>

        <p>
            <img src="../img/yo-help.png" width="600"><br><br>
        </p>                

        <div class="duck-comment">
            <p> â® dis is rly helpful if you forget a scripts name or sumeting! quack quack</p>
        </div><br><br>


        <h2 class="section-title">yo <i>script</i> --help</h2>

        <p>
            <img src="../img/yo-script-help.png" width="600"><br><br>
        </p>                

        <div class="duck-comment">
            <p> â® dis is rly helpful if you forget a scripts parameter or sumeting! quack quack</p>
        </div><br><br><br>



        <details class="code-block-container" style="margin-bottom: 1em;">
          <summary class="code-header">
              <div class="code-lang">â® View Complete yo Structure</div>
          </summary>
              <div class="code-block">
                <pre><span class="duck-version">
{ # ğŸ¦† duck say â® yo! letz do a script yo!
  config,
  lib,
  pkgs,
  ...
} : let
in { # ğŸ¦† duck say â® qwack
  yo = {
    pkgs                # ğŸ¦† duck say â® read-only - final yo scripts package
    sorryPhrases        # ğŸ¦† duck say â® TTS phrases when no voice match found
    SplitWords          # ğŸ¦† duck say â® Words used for command chaining
    wakeWord            # ğŸ¦† duck say â® path to .tflite wake word model
    generatedPatterns   # ğŸ¦† duck say â® read-only - generated regex patterns count
    understandsPhrases  # ğŸ¦† duck say â® read-only - understood phrases count
    
    scripts = {
      example = {
        description     # ğŸ¦† duck say â® script description
        category        # ğŸ¦† duck say â® category for sorting/grouping
        aliases         # ğŸ¦† duck say â® alternative command names
        logLevel        # ğŸ¦† duck say â® duckTrace log level
        helpFooter      # ğŸ¦† duck say â® extra code for --help output
        autoStart       # ğŸ¦† duck say â® run at startup via systemd
        runEvery        # ğŸ¦† duck say â® run periodically every X minutes
        runAt           # ğŸ¦† duck say â® run at specific times daily
        code            # ğŸ¦† duck say â® the actual script cod
        
        voicePatterns   # ğŸ¦† duck say â® read-only - generated regex patterns
        voicePhrases    # ğŸ¦† duck say â® read-only - theoretical phrase coverage
        voiceReady      # ğŸ¦† duck say â® read-only - has voice commands configured
        voice = {
          enabled       # ğŸ¦† duck say â® generate voice intents
          priority      # ğŸ¦† duck say â® processing priority (1=highest)
          fuzzy = {
            enable      # ğŸ¦† duck say â® enable fuzzy voice matching
            threshold   # ğŸ¦† duck say â® similarity threshold (0.0-1.0)
          };
          sentences     # ğŸ¦† duck say â® voice command patterns
          lists         # ğŸ¦† duck say â® entity lists for parameters
            wildcard    # ğŸ¦† duck say â® accept free-form text / wildcard parameter
            values      # ğŸ¦† duck say â® value mappings
              "in" =    # ğŸ¦† duck say â® input value
              out =     # ğŸ¦† duck say â® output value  
            };
          };
        };        
      };
    };  
      
  };}
</span><span class="clean-version hidden">
{
  config,
  lib,
  pkgs,
  ...
} : let
in {
  yo = {
    pkgs                
    sorryPhrases        
    SplitWords          
    wakeWord            
    generatedPatterns   
    understandsPhrases  
    
    scripts = {
      example = {
        description     
        category        
        aliases         
        logLevel        
        helpFooter      
        autoStart       
        runEvery        
        runAt           
        code            
        
        voicePatterns   
        voicePhrases    
        voiceReady      
        voice = {
          enabled       
          priority      
          fuzzy = {
            enable      
            threshold   
          };
          sentences     
          lists         
            wildcard   
            values
              "in" =
              out = 
            };
          };
        };        
      };
    };  
      
  };}
</span></pre>
            </div>
        </div>
    </details>

        
        <h2 class="section-title">Read More?</h2>
        
        <p>
            On the next page, I will explain further and in greater detail what actually happends when you execute a yo script.<br>
            I will also present the source code - so that if you want to - you could create your own.<br>
            
        </p>    


        <div class="callout">
            <p>
                <b><u>Table of Content:</b></u> <br><br>
                <a href="part1.html">Yo! - The Execution Workflow</a><br>                                
            </p>
        </div>

    </div>
    
    <footer>
        <p>All thoughts are my own and should not be considered advice of any kind. More likely the opposite.</p>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const codeBlocks = document.querySelectorAll('details.code-block-container');
            
            codeBlocks.forEach(block => {
                const summary = block.querySelector('summary');
                const codeLang = summary.querySelector('.code-lang');
                const toggleIcon = summary.querySelector('.toggle-icon');
                
                const originalText = codeLang.innerHTML;
                const viewText = originalText.replace('Hide', 'View').replace('â®', 'â®Ÿ');
                const hideText = originalText.replace('View', 'Hide').replace('â®Ÿ', 'â®');
                
                if (block.open) {
                    codeLang.innerHTML = hideText;
                } else {
                    codeLang.innerHTML = viewText;
                }
                
                block.addEventListener('toggle', function() {
                    if (this.open) {
                        codeLang.innerHTML = hideText;
                    } else {
                        codeLang.innerHTML = viewText;
                    }
                });
            });
        });
        document.addEventListener('DOMContentLoaded', function() {
            const duckToggle = document.getElementById('duckToggle');
            let ducksHidden = false;
            
            function toggleCodeDucks() {
                ducksHidden = !ducksHidden;
                
                const duckVersions = document.querySelectorAll('.duck-version');
                const cleanVersions = document.querySelectorAll('.clean-version');
                
                duckVersions.forEach(version => {
                    version.classList.toggle('hidden', ducksHidden);
                });
                
                cleanVersions.forEach(version => {
                    version.classList.toggle('hidden', !ducksHidden);
                });
                
                duckToggle.innerHTML = ducksHidden ? 
                    '<span class="duck-icon"></span> Show ğŸ¦† commentary' : 
                    '<span class="duck-icon"></span> Hide ğŸ¦† commentary';
                    
                const duckIcon = duckToggle.querySelector('.duck-icon');
                duckIcon.style.transform = 'scale(1.2)';
                setTimeout(() => {
                    duckIcon.style.transform = 'scale(1)';
                }, 300);
            }
            
            duckToggle.addEventListener('click', toggleCodeDucks);
            
            document.querySelectorAll('.clean-version').forEach(version => {
                version.classList.add('hidden');
            });
        });
    </script>
</body>
</html>
